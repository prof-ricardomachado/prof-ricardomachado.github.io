<!DOCTYPE html>
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*       on 2021-08-17T16:38:15-03:00       *-->
<!--*   A recent stable commit (2020-08-09):   *-->
<!--* 98f21740783f166a773df4dc83cab5293ab63a4a *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<html lang="pt-BR">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>UFRPE-DM Permutações Caóticas com Repetições</title>
<meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://sagecell.sagemath.org/embedded_sagecell.js"></script><script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [['\\(','\\)']]
    },
    asciimath2jax: {
        ignoreClass: ".*",
        processClass: "has_am"
    },
    jax: ["input/AsciiMath"],
    extensions: ["asciimath2jax.js"],
    TeX: {
        extensions: ["extpfeil.js", "autobold.js", "https://pretextbook.org/js/lib/mathjaxknowl.js", "AMScd.js", ],
        // scrolling to fragment identifiers is controlled by other Javascript
        positionToHash: false,
        equationNumbers: { autoNumber: "none", useLabelIds: true, },
        TagSide: "right",
        TagIndent: ".8em",
    },
    // HTML-CSS output Jax to be dropped for MathJax 3.0
    "HTML-CSS": {
        scale: 88,
        mtextFontInherit: true,
    },
    CommonHTML: {
        scale: 88,
        mtextFontInherit: true,
    },
});
</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML-full"></script><script>$(function () {
    // Make *any* div with class 'sagecell-sage' an executable Sage cell
    // Their results will be linked, only within language type
    sagecell.makeSagecell({inputLocation: 'div.sagecell-sage',
                           linked: true,
                           languages: ['sage'],
                           evalButtonText: 'Evaluate (Sage)'});
});
</script><script xmlns:svg="http://www.w3.org/2000/svg" src="https://pretextbook.org/js/lib/jquery.min.js"></script><script xmlns:svg="http://www.w3.org/2000/svg" src="https://pretextbook.org/js/lib/jquery.sticky.js"></script><script xmlns:svg="http://www.w3.org/2000/svg" src="https://pretextbook.org/js/lib/jquery.espy.min.js"></script><script xmlns:svg="http://www.w3.org/2000/svg" src="https://pretextbook.org/js/0.13/pretext.js"></script><script xmlns:svg="http://www.w3.org/2000/svg" src="https://pretextbook.org/js/0.13/pretext_add_on.js"></script><script xmlns:svg="http://www.w3.org/2000/svg" src="https://pretextbook.org/js/lib/knowl.js"></script><!--knowl.js code controls Sage Cells within knowls--><script xmlns:svg="http://www.w3.org/2000/svg">sagecellEvalName='Evaluate (Sage)';
</script><link xmlns:svg="http://www.w3.org/2000/svg" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,600,600italic" rel="stylesheet" type="text/css">
<link xmlns:svg="http://www.w3.org/2000/svg" href="https://fonts.googleapis.com/css?family=Inconsolata:400,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css">
<link xmlns:svg="http://www.w3.org/2000/svg" href="https://pretextbook.org/css/0.31/pretext.css" rel="stylesheet" type="text/css">
<link xmlns:svg="http://www.w3.org/2000/svg" href="https://pretextbook.org/css/0.31/pretext_add_on.css" rel="stylesheet" type="text/css">
<link xmlns:svg="http://www.w3.org/2000/svg" href="https://pretextbook.org/css/0.31/banner_default.css" rel="stylesheet" type="text/css">
<link xmlns:svg="http://www.w3.org/2000/svg" href="https://pretextbook.org/css/0.31/toc_default.css" rel="stylesheet" type="text/css">
<link xmlns:svg="http://www.w3.org/2000/svg" href="https://pretextbook.org/css/0.31/knowls_default.css" rel="stylesheet" type="text/css">
<link xmlns:svg="http://www.w3.org/2000/svg" href="https://pretextbook.org/css/0.31/style_default.css" rel="stylesheet" type="text/css">
<link xmlns:svg="http://www.w3.org/2000/svg" href="https://pretextbook.org/css/0.31/colors_default.css" rel="stylesheet" type="text/css">
<link xmlns:svg="http://www.w3.org/2000/svg" href="https://pretextbook.org/css/0.31/setcolors.css" rel="stylesheet" type="text/css">
<!-- 2019-10-12: Temporary - CSS file for experiments with styling --><link xmlns:svg="http://www.w3.org/2000/svg" href="developer.css" rel="stylesheet" type="text/css">
</head>
<body class="mathbook-book has-toc has-sidebar-left">
<a class="assistive" href="#content">[skip-to-content]</a><div xmlns:svg="http://www.w3.org/2000/svg" class="hidden-content" style="display:none">\(\newcommand{\identity}{\mathrm{id}}
\newcommand{\notdivide}{{\not{\mid}}}
\newcommand{\notsubset}{\not\subset}
\newcommand{\lcm}{\operatorname{lcm}}
\newcommand{\gf}{\operatorname{GF}}
\newcommand{\inn}{\operatorname{Inn}}
\newcommand{\aut}{\operatorname{Aut}}
\newcommand{\Hom}{\operatorname{Hom}}
\newcommand{\cis}{\operatorname{cis}}
\newcommand{\chr}{\operatorname{char}}
\newcommand{\Null}{\operatorname{Null}}
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\)</div>
<header id="masthead" class="smallbuttons"><div class="banner"><div class="container">
<a id="logo-link" href=""></a><div class="title-container">
<h1 class="heading"><a href="indice.html"><span class="title">Análise Combinatória e Probabilidade:</span> <span class="subtitle">Com Aplicações no SageMath</span></a></h1>
<p class="byline">Ricardo Nunes Machado Junior, Luiz Manoel de Santana Neto</p>
</div>
</div></div>
<nav xmlns:svg="http://www.w3.org/2000/svg" id="primary-navbar" class="navbar"><div class="container">
<div class="navbar-top-buttons">
<button class="sidebar-left-toggle-button button active" aria-label="Show or hide table of contents sidebar">Sumário</button><div class="tree-nav toolbar toolbar-divisor-3"><span class="threebuttons"><a id="previousbutton" class="previous-button toolbar-item button" href="section-permutacao-caotica.html" title="Anterior">Anterior</a><a id="upbutton" class="up-button button toolbar-item" href="ocontagem.html" title="Acima">Acima</a><a id="nextbutton" class="next-button button toolbar-item" href="section-lemas-kaplansky.html" title="Próximo">Próximo</a></span></div>
</div>
<div class="navbar-bottom-buttons toolbar toolbar-divisor-4">
<button class="sidebar-left-toggle-button button toolbar-item active">Sumário</button><a class="previous-button toolbar-item button" href="section-permutacao-caotica.html" title="Anterior">Anterior</a><a class="up-button button toolbar-item" href="ocontagem.html" title="Acima">Acima</a><a class="next-button button toolbar-item" href="section-lemas-kaplansky.html" title="Próximo">Próximo</a>
</div>
</div></nav></header><div class="page">
<div xmlns:svg="http://www.w3.org/2000/svg" id="sidebar-left" class="sidebar" role="navigation"><div class="sidebar-content">
<nav id="toc"><ul>
<li class="link frontmatter">
<a href="frontmatter.html" data-scroll="frontmatter"><span class="title">Pré-textual</span></a><ul>
<li><a href="prof-ricardo-machado.html" data-scroll="prof-ricardo-machado">Sobre Ricardo Nunes Machado Junior</a></li>
<li><a href="prof-luiz-manoel.html" data-scroll="prof-luiz-manoel">Sobre Luiz Manoel de Santana Neto</a></li>
<li><a href="preface.html" data-scroll="preface">Prefácio</a></li>
</ul>
</li>
<li class="link">
<a href="pcontagem.html" data-scroll="pcontagem"><span class="codenumber">1</span> <span class="title">Princípios de Contagem</span></a><ul>
<li><a href="section-1.html" data-scroll="section-1">Conjuntos</a></li>
<li><a href="section-note-on-proofs.html" data-scroll="section-note-on-proofs">Princípio Aditivo e Princípio Multiplicativo</a></li>
<li><a href="section-permutacoes-simples.html" data-scroll="section-permutacoes-simples">Permutações Simples</a></li>
<li><a href="section-combinacoes-simples.html" data-scroll="section-combinacoes-simples">Combinações Simples</a></li>
<li><a href="section-permutacoes-circulares.html" data-scroll="section-permutacoes-circulares">Permutações Circulares</a></li>
<li><a href="section-permutacoes-com-repeticoes.html" data-scroll="section-permutacoes-com-repeticoes">Permutações com Repetições</a></li>
<li><a href="section-combinacoes-completas.html" data-scroll="section-combinacoes-completas">Combinações Completas</a></li>
</ul>
</li>
<li class="link">
<a href="ocontagem.html" data-scroll="ocontagem"><span class="codenumber">2</span> <span class="title">Outros Métodos de Contagem</span></a><ul>
<li><a href="section-inclusao-exclusao.html" data-scroll="section-inclusao-exclusao">Princípio da Inclusão-Exclusão</a></li>
<li><a href="section-permutacao-caotica.html" data-scroll="section-permutacao-caotica">Permutações Caóticas</a></li>
<li><a href="section-permutacao-caotica-repeticoes.html" data-scroll="section-permutacao-caotica-repeticoes" class="active">Permutações Caóticas com Repetições</a></li>
<li><a href="section-lemas-kaplansky.html" data-scroll="section-lemas-kaplansky">Os Lemas de Kaplansky</a></li>
<li><a href="section-casa-pombos.html" data-scroll="section-casa-pombos">Princípio da Casa dos Pombos</a></li>
</ul>
</li>
<li class="link">
<a href="binomiais.html" data-scroll="binomiais"><span class="codenumber">3</span> <span class="title">Números Binomiais</span></a><ul>
<li><a href="section-triangulo-pascal.html" data-scroll="section-triangulo-pascal">Triângulo de Pascal</a></li>
<li><a href="section-binomio-newton.html" data-scroll="section-binomio-newton">Binômio de Newton</a></li>
<li><a href="section-polinomio-leibniz.html" data-scroll="section-polinomio-leibniz">Polinômio de Leibniz</a></li>
</ul>
</li>
<li class="link">
<a href="probabilidade.html" data-scroll="probabilidade"><span class="codenumber">4</span> <span class="title">Probabilidade</span></a><ul>
<li><a href="section-espacos-probabilidade.html" data-scroll="section-espacos-probabilidade">Espaços de Probabilidade</a></li>
<li><a href="section-probabilidade-condicional.html" data-scroll="section-probabilidade-condicional">Probabilidade Condicional</a></li>
<li><a href="section-distribuicao-binomial.html" data-scroll="section-distribuicao-binomial">Distribuição Binomial</a></li>
</ul>
</li>
<li class="link"><a href="referencias.html" data-scroll="referencias"><span class="codenumber">5</span> <span class="title">Referências Bibliográficas</span></a></li>
</ul></nav><div class="extras"><nav><a class="mathbook-link" href="https://pretextbook.org">Feito com PreTeXt</a><a href="https://www.mathjax.org"><img title="Powered by MathJax" src="https://www.mathjax.org/badge/badge.gif" alt="Powered by MathJax"></a></nav></div>
</div></div>
<main class="main"><div id="content" class="pretext-content"><section xmlns:svg="http://www.w3.org/2000/svg" class="section" id="section-permutacao-caotica-repeticoes"><h2 class="heading hide-type">
<span class="type">Seção</span> <span class="codenumber">2.3</span> <span class="title">Permutações Caóticas com Repetições</span>
</h2>
<article class="objectives goal-like" id="dEf"><h6 class="heading"><span class="type">Objetivos</span></h6>
<ol class="decimal">
<li id="li-88">Definir Permutação Caótica com Repetição.</li>
<li id="li-89">Exemplificar.</li>
<li id="li-90">Definir uma função no Sage para calcular o número de permutações caóticas.</li>
</ol></article><section class="subsection" id="subsection-12"><h3 class="heading hide-type">
<span class="type">Subseção</span> <span class="codenumber">2.3.1</span> <span class="title">Permutações Caóticas com Repetições</span>
</h3>
<p id="p-494">Quando estamos contando o número de permutações, precisamos levar em consideração se todos os elementos são distintos ou não, pois a permutação de dois elementos idênticos não gera uma nova permutação, como não podia ser diferente, isso também vale no caso das permutações caóticas.</p>
<article class="definition definition-like" id="definition-16"><h6 class="heading">
<span class="type">Definição</span><span class="space"> </span><span class="codenumber">2.3.1</span><span class="period">.</span>
</h6>
<p id="p-495">Uma permutação caótica de uma lista que possui elementos repetidos é chamada de <em class="emphasis">permutação caótica com repetição</em>, ou seja, cada elemento não pode ocupar sua posição original, levando em conta que elementos idênticos nem podem ocupar sua posição original, nem as posições originais de seus elementos idênticos.</p>
<p id="p-496">Por exemplo, MARAAEL é uma permutação caótica (com repetição) das letras da palavra AMARELA. Note que as letras A não podem ocupar as posições 1, 3 ou 7.</p>
<p id="p-497">Em qualquer caso, tendo repetição ou não, chamaremos apenas de <em class="emphasis">permutação caótica</em>, precisamos apenas identificar em cada problema, a existência ou não de elementos repetidos, para que a contagem do número de permutações caóticas seja feita da forma correta.</p></article><article class="example example-like" id="exem-amarela"><h6 class="heading">
<span class="type">Exemplo</span><span class="space"> </span><span class="codenumber">2.3.2</span><span class="period">.</span>
</h6>
<p id="p-498">Quantos são os anagramas da palavra AMARELA, sem que as letras fiquem nas posições originais?</p></article><article class="technology computation-like" id="technology-17"><h6 class="heading">
<span class="type">Tecnologia</span><span class="space"> </span><span class="codenumber">2.3.3</span><span class="period">.</span>
</h6>Usando o Sage, podemos obter a resposta desse problema sem dificuldade alguma. Com o código abaixo, basta clicar em "Evaluate (Sage)" para obter a resposta. <div class="sagecell-sage" id="sage-31"><script type="text/x-sage">len(Derangements(['A', 'M', 'A', 'R', 'E', 'L', 'A']))
</script></div></article><p id="p-499">Ao longo dessa seção, esse problema está resolvido sem depender do uso de um computador/software. Porém, alguns códigos estão disponíveis, apenas para facilitar/conferir contas que podem ser feitas à mão. A solução foi desenvolvida de forma que a mesma ideia se aplique em casos mais gerais, no qual, mais de uma letra distinta se repete.</p>
<p id="p-500">Para resolver o <a class="xref" data-knowl="./knowl/exem-amarela.html" title="Exemplo 2.3.2">Exemplo 2.3.2</a>, observe que o número de soluções para a palavra AMARELA é o mesmo que o número de soluções para a "palavra" AAAMREL, pois uma palavra é um anagrama da outra, então para cada permutação caótica de AAAMREL, podemos obter uma única permutação caótica da palavra AMARELA, apenas aplicando a mesma permutação que leva AAAMREL em AMARELA.</p>
<p id="p-501">Vamos contar o número de permutações caóticas de AAAMREL para facilitar a explicação. Inicialmente troque AAAMREL por A\(_1\)A\(_2\)A\(_3\)MREL, pois assim todas as letras ficam diferentes, depois resolvemos o problema das permutações das letras A. Em seguida colocamos a palavra em um tabuleiro e usamos torres para representar as permutações. Cada permutação da palavra é representada por uma única forma de colocar \(7\) torres em um tabuleiro \(7\times 7\text{,}\) de forma que uma torre não possa atacar a outra, ou seja, em linhas e colunas diferentes. Por exemplo</p>
<figure class="figure figure-like" id="fig-permuta"><div class="image-box" style="width: 65%; margin-left: 17.5%; margin-right: 17.5%;"><img src="images/permuta.svg" role="img" style="width: 100%; height: auto;" alt=""></div>
<figcaption><span class="type">Figura</span><span class="space"> </span><span class="codenumber">2.3.4<span class="period">.</span></span><span class="space"> </span>Tabela de Permutação.</figcaption></figure><p id="p-502">fica com a seguinte configuração no tabuleiro:</p>
<figure class="figure figure-like" id="fig-tabuleiro"><div class="image-box" style="width: 50%; margin-left: 25%; margin-right: 25%;"><img src="images/tabuleiro.svg" role="img" style="width: 100%; height: auto;" alt=""></div>
<figcaption><span class="type">Figura</span><span class="space"> </span><span class="codenumber">2.3.5<span class="period">.</span></span><span class="space"> </span>Tabuleiro da permutação MRELA\(_1\)A\(_2\)A\(_3\text{.}\)</figcaption></figure><p id="p-503">Para uma permutação simples, as torres podem ocupar qualquer quadrado, desde que uma não possa atacar a outra. No nosso caso, os quadrados cinzas são os lugares que não queremos colocar as torres, pois assim estamos evitando os casos em que alguma letra fica em seu lugar original. Chamaremos de <em class="emphasis">subtabuleiro proibido</em>, o subtabuleiro que não queremos colocar as torres.</p>
<p id="p-504">Defina \(B_k = \) colocações de torres, na qual, a torre da linha \(k\) está em um subtabuleiro proibido.</p>
<p id="p-505">A resposta do nosso problema será dado por</p>
<div class="displaymath">
\begin{equation*}
\frac{\#(B_1\cup B_2\cup \cdots \cup B_7)^c}{3!}, 
\end{equation*}
</div>
<p data-braille="continuation">ou seja, o número de elementos do complementar de \((B_1\cup B_2\cup \cdots \cup B_7)\text{,}\) dividido pelo número de maneiras de permutar as letras \(A_1, A_2, A_3\text{.}\)</p>
<p id="p-506">Pelo princípio da Inclusão-Exclusão, isso pode ser calculado da seguinte maneira:</p>
<div class="displaymath">
\begin{equation}
7! -  \sum_{i=1}^7 \#B_i + \sum_{0\lt i \lt j\leq 7}\#(B_i\cap B_j)+\cdots+(-1)^{7}\#(B_1\cap \cdots\cap B_7).\label{eq-PIE02}\tag{2.3.1}
\end{equation}
</div>
<p id="p-507">A seguir, será mostrado que cada somatório da equação <a class="xref" data-knowl="./knowl/eq-PIE02.html" title="[men] 2.3.1">(2.3.1)</a>  envolvendo interseções de \(k\) conjuntos,  pode ser calculado pelo produto de um valor \(r_k\text{,}\) a ser determinado, pelo fatorial de \((7-k)\text{.}\) Observe que</p>
<div class="displaymath">
\begin{equation*}
\sum_{i=1}^7 \#B_i = r_1\cdot (7-1)! 
\end{equation*}
</div>
<p data-braille="continuation">com \(r_1=13\text{,}\) pois se \(i\in \{1 ,2, 3\}\) temos 3 opções para colocar a torre na linha \(i\text{,}\) sobrando 6 torres para colocar cada uma em uma linha, logo \(\#B_i = 3\cdot 6!\text{.}\) Para \(j\in \{4, 5, 6, 7\}\text{,}\) \(\#B_j = 6!\text{,}\) pois temos apenas um lugar para colocar a torre na linha \(j\text{,}\) sobrando 6 torres para colocar cada uma em uma linha. Portanto, o valor do somatório é dado por</p>
<div class="displaymath">
\begin{equation*}
3\cdot 6!+3\cdot 6!+3\cdot 6!+6!+6!+6!+6! = 13\cdot 6!.
\end{equation*}
</div>
<p data-braille="continuation">Seguindo com esse raciocínio, temos</p>
<div class="displaymath">
\begin{equation*}
\sum_{0\lt i\lt j\leq 7} \#(B_i\cap B_j) = r_2\cdot (7-2)! 
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
\vdots 
\end{equation*}
</div>
<div class="displaymath">
\begin{equation*}
\#(B_1\cap \cdots \cap B_7) = r_7\cdot (7-7)! 
\end{equation*}
</div>
<p data-braille="continuation">O problema agora é determinar os valores de cada \(r_i\text{.}\) Uma forma prática de fazer isso é usando o polinômio de torre:</p>
<article class="definition definition-like" id="def-ptorre"><h6 class="heading">
<span class="type">Definição</span><span class="space"> </span><span class="codenumber">2.3.6</span><span class="period">.</span>
</h6>
<p id="p-508">Seja \(T\) um tabuleiro qualquer. O <em class="emphasis">polinômio de torre</em> de \(T\) é definido como</p>
<div class="displaymath">
\begin{equation*}
R(x, T) = \sum_{k=0}^n r_k(T)x^k, 
\end{equation*}
</div>
<p data-braille="continuation">no qual, \(r_k(T)\) é o número de maneiras de colocar \(k\) torres em \(T\text{,}\) de forma que uma torre não possa atacar a outra e \(n\) é o número máximo de torres que é possível colocar em \(T\text{,}\) de forma que uma torre não possa atacar a outra. Em inglês esse polinômio é chamado de <em class="emphasis">Rook Polynomial</em>, para mais informações veja <a class="xref" data-knowl="./knowl/Holton.html" title="[biblio] 5.9: A Second Step to Mathematical Olympiad Problems">[5.9]</a>.</p></article><p id="p-509">Note que na <a class="xref" data-knowl="./knowl/def-ptorre.html" title="Definição 2.3.6">Definição 2.3.6</a>, o tabuleiro não precisa ser quadrado nem retangular, pode inclusive ser um tabuleiro formado apenas pela parte cinza do tabuleiro da <a class="xref" data-knowl="./knowl/fig-tabuleiro.html" title="Figura 2.3.5">Figura 2.3.5</a>.</p>
<article class="theorem theorem-like" id="theorem-17"><h6 class="heading">
<span class="type">Teorema</span><span class="space"> </span><span class="codenumber">2.3.7</span><span class="period">.</span>
</h6>
<p id="p-510">Seja \(T\) um tabuleiro \(n\times n\text{.}\) O número de formas de colocar \(k\) torres em \(T\text{,}\) (\(k = 0, 1, \ldots, n\)) de forma que uma não possa atacar a outra é dado pelo coeficiente de \(x^k\) do polinômio:</p>
<div class="displaymath">
\begin{equation*}
R(x, T) = \sum_{k=0}^n\left(C_n^k\right)^2\cdot k!\cdot x^k.
\end{equation*}
</div></article><article class="hiddenproof" id="proof-18"><a data-knowl="" class="id-ref proof-knowl original" data-refid="hk-proof-18"><h6 class="heading"><span class="type">Demonstração<span class="period">.</span></span></h6></a></article><div class="hidden-content tex2jax_ignore" id="hk-proof-18"><article class="hiddenproof"><p id="p-511">Precisamos escolher \(k\) linhas e \(k\) colunas no tabuleiro \(T\text{,}\) \(n\times n\text{,}\) para colocar as torres, de modo que uma torre não possa atacar a outra, isto pode ser feito de \(\left(C_n^k\right)^2\) maneiras. Agora precisamos escolher a posição da linha 1 na qual será colocada a primeira torre, isso pode ser feito de \(k\) maneiras, em seguida, precisamos escolher a posição da linha 2 na qual será colocada a segunda torre, o que pode ser feito de \((k-1)\) maneiras, e assim por diante, até ficarmos com uma maneira de escolher a \(k\)-ésima torre.</p>
<p id="p-512">Assim, pelo princípio multiplicativo, o número de maneiras de colocar \(k\) torres em \(T\text{,}\) de modo que uma torre não possa atacar a outra é</p>
<div class="displaymath">
\begin{equation*}
\left(C_n^k\right)^2\cdot k!.
\end{equation*}
</div></article></div>
<article class="example example-like" id="example-34"><h6 class="heading">
<span class="type">Exemplo</span><span class="space"> </span><span class="codenumber">2.3.8</span><span class="period">.</span>
</h6>
<p id="p-513">Sejam \(T^i\text{,}\) tabuleiros \(i\times i\text{,}\) \(i = 1, 2, 3\text{,}\) então</p>
<div class="displaymath">
\begin{align*}
R(x, T^1)= \amp ~ x+1.  \\
R(x, T^2)= \amp ~ 2x^2 + 4x +1.  \\
R(x, T^3)= \amp ~ 6x^3 + 18x^2 + 9x +1.   
\end{align*}
</div></article><article class="technology computation-like" id="tech-politorre01"><h6 class="heading">
<span class="type">Tecnologia</span><span class="space"> </span><span class="codenumber">2.3.9</span><span class="period">.</span>
</h6>
<p id="p-514">A seguir, temos os códigos para gerar o polinômio de torre de um tabuleiro \(n\times n\text{.}\) Na linha 1, definimos uma matriz \(4\times 4\) de uns e guardamos na variável <dfn class="terminology">B</dfn>. Para obter o polinômio de torre de um tabuleiro quadrado diferente, troque o número 4 da linha 1 pelo valor desejado e clique em "Evaluate (Sage)".</p>
<div class="sagecell-sage" id="sage-32"><script type="text/x-sage">B = matrix.ones(4)
R = PolynomialRing(ZZ, 'x')
show(R(B.rook_vector()))
</script></div>
<p id="p-515">Para entender melhor as implementações das funções escritas em Sage, veja a referência <a class="xref" data-knowl="./knowl/sage.html" title="[biblio] 5.5">[5.5]</a></p></article><article class="definition definition-like" id="definition-18"><h6 class="heading">
<span class="type">Definição</span><span class="space"> </span><span class="codenumber">2.3.10</span><span class="period">.</span>
</h6>
<p id="p-516">Dizemos que a união de dois tabuleiros \(T_1\) e \(T_2\) é uma união disjunta, quando nenhum quadrado de \(T_1\) está na mesma linha ou mesma coluna de \(T_2\text{.}\)</p></article><article class="example example-like" id="example-35"><h6 class="heading">
<span class="type">Exemplo</span><span class="space"> </span><span class="codenumber">2.3.11</span><span class="period">.</span>
</h6>
<p id="p-517">Sejam \(T^i\text{,}\) tabuleiros \(i\times i\text{,}\) \(i = 1, 2\text{,}\) então o polinômio de torre da união disjunta \(T^2\cup T^1\) é o produto dos polinômios de torre de \(T^2\) e \(T^1\text{.}\)</p>
<a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-77" id="solution-77"><span class="type">Solução</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-77"><div class="solution solution-like">
<p id="p-518">O polinômio de torre \(R(x, T^2\cup T^1)\) pode ser obtido fazendo todas as figuras, da seguinte forma:</p>
<figure class="figure figure-like" id="fig-tabuleirouniao2"><div class="image-box" style="width: 40%; margin-left: 30%; margin-right: 30%;"><img src="images/tabuleirouniao2.svg" role="img" style="width: 100%; height: auto;" alt=""></div>
<figcaption><span class="type">Figura</span><span class="space"> </span><span class="codenumber">2.3.12<span class="period">.</span></span><span class="space"> </span>Polinômio de Torre do tabuleiro \(T^2\cup T^1\text{.}\)</figcaption></figure><p id="p-519">Calculando o produto dos polinômios de torre de \(T^2\) e \(T^1\text{,}\) obtemos</p>
<div class="displaymath">
\begin{align*}
R(x, T^2)\cdot R(x, T^1)= \amp ~ (2x^2+4x+1)(x+1)  \\
= \amp ~ 2x^3+6x^2+5x+1.  
\end{align*}
</div>
<p data-braille="continuation">Portanto,</p>
<div class="displaymath">
\begin{equation*}
R(x, T^2\cup T^1) = R(x, T^2)\cdot R(x, T^1).
\end{equation*}
</div>
</div></div></article><article class="proposition theorem-like" id="prop-uniaodis"><h6 class="heading">
<span class="type">Proposição</span><span class="space"> </span><span class="codenumber">2.3.13</span><span class="period">.</span>
</h6>
<p id="p-520">O polinômio de torre da união disjunta de dois tabuleiros é dado pelo produto dos polinômios de torre de cada um dos tabuleiros.</p></article><article class="hiddenproof" id="proof-19"><a data-knowl="" class="id-ref proof-knowl original" data-refid="hk-proof-19"><h6 class="heading"><span class="type">Demonstração<span class="period">.</span></span></h6></a></article><div class="hidden-content tex2jax_ignore" id="hk-proof-19"><article class="hiddenproof"><p id="p-521">Seja \(T\) um tabuleiro obtido pela união disjunta de dois tabuleiros \(T_1\) e \(T_2\text{.}\)</p>
<p id="p-522">Para colocar \(k\) torres em \(T\text{,}\) de forma que uma torre não possa atacar a outra, podemos colocar \(r_{k-i}(T_1)\text{,}\) \(0\leq i \leq k\text{,}\) torres em \(T_1\text{,}\) de forma que uma não possa atacar a outra, e \(r_{i}(T_2)\) torres em \(T_2\text{,}\) de forma que uma não possa atacar a outra. Dessa forma, dados duas torres quaisquer em \(T\text{,}\) na configuração obtida anteriormente, uma não pode atacar a outra. Portanto, o número de maneiras de colocarmos \(k\) torres em \(T\) é dado por</p>
<div class="displaymath">
\begin{equation*}
r_k(T) = \sum_{i=0}^k r_{k-i}(T_1)r_i(T_2).
\end{equation*}
</div>
<p data-braille="continuation">Logo,</p>
<div class="displaymath">
\begin{align*}
R(x, T) = \amp ~ \sum_{k=0}^nr_k(T)x^k  \\
= \amp ~ \sum_{k=0}^n\sum_{i=0}^kr_{k-i}(T_1)r_i(T_2)x^k  \\
= \amp ~ \left( \sum_{s=0}^pr_s(T_1)x^s \right)\left( \sum_{t=0}^qr_t(T_2)x^t \right) \\
= \amp ~ R(x, T_1)\cdot R(x, T_2).
\end{align*}
</div></article></div>
<article class="technology computation-like" id="technology-19"><h6 class="heading">
<span class="type">Tecnologia</span><span class="space"> </span><span class="codenumber">2.3.14</span><span class="period">.</span>
</h6>
<p id="p-523">Aqui temos uma implementação para obter o produto de polinômios de torre. Usamos a ideia apresentada na <a class="xref" data-knowl="./knowl/tech-politorre01.html" title="Tecnologia 2.3.9">Tecnologia 2.3.9</a> para gerar cada polinômio e definimos a função \(\verb|produto_polinomios_torre|\) que multiplica cada um dos polinômios de torre. As entradas da função \(\verb|produto_polinomios_torre|\) são os tamanhos dos tabuleiros. Na linha 8 a função está sendo "chamada" para gerar a polinômio de torre da união disjunta de um tabuleiro \(3\times 3\) e 4 tabuleiros \(1\times 1\text{.}\)</p>
<div class="sagecell-sage" id="sage-33"><script type="text/x-sage">def produto_polinomios_torre(*lista):
    R = PolynomialRing(ZZ, 'x')
    p = R(1)
    for n in lista:
        B = matrix.ones(n)
        p = p*R(B.rook_vector())
    return show(p)
produto_polinomios_torre(3, 1, 1, 1, 1)
</script></div></article><p id="p-524">Voltando a solução do <a class="xref" data-knowl="./knowl/exem-amarela.html" title="Exemplo 2.3.2">Exemplo 2.3.2</a>. Pela <a class="xref" data-knowl="./knowl/prop-uniaodis.html" title="Proposição 2.3.13">Proposição 2.3.13</a> o polinômio de torre do tabuleiro da palavra AAAMREL é dado por</p>
<div class="displaymath">
\begin{equation}
R(x, T) =  ~ (6x^3 + 18x^2 + 9x +1)(x+1)^4.\label{paaa}\tag{2.3.2}
\end{equation}
</div>
<p data-braille="continuation">Fazendo as contas, obtemos</p>
<div class="displaymath">
\begin{equation}
R(x, T) =  6x^{7} + 42x^{6} + 117x^{5} + 169x^{4} + 136x^{3} + 60x^{2} + 13x^1 + 1x^0. \label{eq-poli-torre}\tag{2.3.3}
\end{equation}
</div>
<p data-braille="continuation">Observe que eram exatamente os coeficientes desse polinômio que estavam faltando para resolvermos o problema pelo princípio da Inclusão-Exclusão dado pela equação <a class="xref" data-knowl="./knowl/eq-PIE02.html" title="[men] 2.3.1">(2.3.1)</a>. Então a solução do <a class="xref" data-knowl="./knowl/exem-amarela.html" title="Exemplo 2.3.2">Exemplo 2.3.2</a> é dada pelo polinômio de torre dado pela equação <a class="xref" data-knowl="./knowl/eq-poli-torre.html" title="[men] 2.3.3">(2.3.3)</a>, com \(x^k\) substituído por \((-1)^k\cdot(7-k)!\text{,}\) dividido por \(3!\text{,}\) pois temos que descontar o número de formas de ordenar as três letras A. Fazendo as substituições, obtemos:</p>
<div class="displaymath">
\begin{equation}
7!  -13\cdot6! + 60\cdot5! - 136\cdot4! + 169\cdot 3! - 117\cdot 2! + 42\cdot 1! -6\cdot 0!\label{naaa}\tag{2.3.4}
\end{equation}
</div>
<p data-braille="continuation">Calculando <a class="xref" data-knowl="./knowl/naaa.html" title="[men] 2.3.4">(2.3.4)</a> e dividido por \(3!\text{,}\) resulta em</p>
<div class="displaymath">
\begin{equation*}
\frac{432}{6} = 72 \text{ soluções}.
\end{equation*}
</div>
<article class="technology computation-like" id="technology-20"><h6 class="heading">
<span class="type">Tecnologia</span><span class="space"> </span><span class="codenumber">2.3.15</span><span class="period">.</span>
</h6>
<p id="p-525">A implementação de uma função que substitui \(x^k\) por \((-1)^k\cdot(n-k)!\) em um polinômio de grau \(n\text{.}\) Na linha 14 a função está sendo "chamada" com o polinômio: \(6x^7 + 42x^6 + 117x^5 + 169x^4 + 136x^3 + 60x^2 + 13x + 1\text{.}\)</p>
<div class="sagecell-sage" id="sage-34"><script type="text/x-sage">def substituicao(p):
    c = p.coefficients()   # lista de coeficientes
    d = p.degree(x)        # grau máximo
    s = 0
    for i in c:
        s = s + i[0]*(-1)^i[1]*factorial(d-i[1])
    return s
substituicao(6*x^7 + 42*x^6 + 117*x^5 + 169*x^4 + 136*x^3 + 60*x^2 + 13*x + 1)
</script></div></article><article class="example example-like" id="exem-perguntainternet"><h6 class="heading">
<span class="type">Exemplo</span><span class="space"> </span><span class="codenumber">2.3.16</span><span class="period">.</span>
</h6>
<p id="p-526">Quantos são os anagramas da palavra MATEMÁTICA, sem que as letras fiquem nas posições originais? (Supondo que A e Á são letras iguais)</p>
<a data-knowl="" class="id-ref solution-knowl original" data-refid="hk-solution-78" id="solution-78"><span class="type">Solução</span></a><div class="hidden-content tex2jax_ignore" id="hk-solution-78"><div class="solution solution-like">
<p id="p-527">O polinômio de torre desse caso é dado por</p>
<div class="displaymath">
\begin{equation*}
(6x^3+18x^2+9x+1)(2x^2+4x+1)^2(x+1)^3.
\end{equation*}
</div>
<p data-braille="continuation">Expandindo o polinômio obtemos</p>
<div class="displaymath">
\begin{equation*}
1x^0   + 20x^1 + 164x^{2}+ 728x^{3} + 1941x^{4}+ 3260x^{5} + 3514x^{6}+ 2416x^{7}+ 1020x^{8}+ 240x^{9}+24x^{10}. 
\end{equation*}
</div>
<p id="p-528">Trocando \(x^k\) por \((-1)^k\cdot(10-k)!\) obtemos:</p>
<div class="displaymath">
\begin{equation*}
10! - 20\cdot9! + 164\cdot8! - 728\cdot7! + 1941\cdot6! - 3260\cdot5! + 3514\cdot4! - 2416\cdot3! + 1020\cdot2!- 240\cdot1!+24\cdot0!
\end{equation*}
</div>
<p data-braille="continuation">Fazendo esse cálculo e dividindo por \(3!\times 2!\times 2!\) chegamos na resposta:</p>
<div class="displaymath">
\begin{equation*}
\frac{392544}{3!\times 2!\times 2!} = 16356 \text{ soluções}.
\end{equation*}
</div>
</div></div></article><article class="technology computation-like" id="tec-caotica-r"><h6 class="heading">
<span class="type">Tecnologia</span><span class="space"> </span><span class="codenumber">2.3.17</span><span class="period">.</span><span class="space"> </span><span class="title">Faça você mesmo.</span>
</h6>
<p id="p-529">A resposta do <a class="xref" data-knowl="./knowl/exem-perguntainternet.html" title="Exemplo 2.3.16">Exemplo 2.3.16</a> junto com o polinômio de torre associado está disponível aqui. Troque as informações da lista para obter o número de permutações caóticas de outra palavra desejada.</p>
<p id="p-530">Obs. Para que o sistema atualize a resposta, basta clicar fora do campo de preenchimento, depois de atualizar os dados.</p>
<iframe id="interactive-caotica-r" width="600" height="420" src="interactive-caotica-r-if.html"></iframe></article></section><section class="subsection" id="subsection-13"><h3 class="heading hide-type">
<span class="type">Subseção</span> <span class="codenumber">2.3.2</span> <span class="title">Teorema das Permutações Caóticas com Repetições</span>
</h3>
<p id="p-531">Na matemática, os polinômios de Laguerre, nomeados em homenagem a Edmond Laguerre (1834-1886), são soluções da equação de Laguerre:</p>
<div class="displaymath">
\begin{equation*}
xy''+ (1-x)y' + ny = 0
\end{equation*}
</div>
<p data-braille="continuation">que é uma equação diferencial linear de segunda ordem. Esses polinômios surgiram na mecânica quântica, na parte radial da solução da equação de Schrödinger para um átomo de um elétron. Eles também descrevem as funções de Wigner estáticas de sistemas osciladores em mecânica quântica no espaço de fase.</p>
<p id="p-532">Fonte: <a class="external" href="https://en.wikipedia.org/wiki/Laguerre_polynomials" target="_blank"><dfn class="terminology">en.wikipedia.org/wiki/Laguerre_polynomials</dfn></a></p>
<p id="p-533">Os polinômios de torre, em combinatória, são mais ou menos os mesmos que os polinômios de Laguerre, a menos de mudanças elementares de variáveis. Usaremos os polinômios de Laguerre para enunciar um Teorema com uma fórmula para calcular permutações caóticas com repetições usando integrais.</p>
<article class="definition definition-like" id="definition-19"><h6 class="heading">
<span class="type">Definição</span><span class="space"> </span><span class="codenumber">2.3.18</span><span class="period">.</span>
</h6>
<p id="p-534">Usando recursividade é possível chegar na seguinte forma fechada para os polinômios de Laguerre:</p>
<div class="displaymath">
\begin{equation*}
L_n(x) = \sum_{k=0}^nC_n^k \frac{(-1)^k}{k!}x^k
\end{equation*}
</div></article><article class="technology computation-like" id="technology-22"><h6 class="heading">
<span class="type">Tecnologia</span><span class="space"> </span><span class="codenumber">2.3.19</span><span class="period">.</span>
</h6>
<p id="p-535">Obtendo o polinômio de Laguerre \(L_3(x)\) no Sage.</p>
<div class="sagecell-sage" id="sage-35"><script type="text/x-sage">laguerre(3,x).show()
</script></div></article><article class="theorem theorem-like" id="teo-permutacao-caotica-repet"><h6 class="heading">
<span class="type">Teorema</span><span class="space"> </span><span class="codenumber">2.3.20</span><span class="period">.</span>
</h6>
<p id="p-536">O número de permutações caóticas, \(DR_n^{r_1, r_2, \ldots, r_k}\text{,}\) de uma lista com \(n\) objetos, com um objeto repetido \(r_1\) vezes, outro objeto repetido \(r_2\) vezes, até o "último" objeto repetido \(r_k\) vezes, tal que \(r_1+r_2+\cdots +r_k = n\text{,}\) pode ser calculado da seguinte maneira:</p>
<div class="displaymath">
\begin{equation*}
DR_n^{r_1, r_2, \ldots, r_k} = \left|\int_0^\infty e^{-x} L_{r_1}(x)L_{r_2}(x)\cdots L_{r_k}(x) ~dx \right|
\end{equation*}
</div></article><article class="hiddenproof" id="proof-20"><a data-knowl="" class="id-ref proof-knowl original" data-refid="hk-proof-20"><h6 class="heading"><span class="type">Demonstração<span class="period">.</span></span></h6></a></article><div class="hidden-content tex2jax_ignore" id="hk-proof-20"><article class="hiddenproof"><p id="p-537">Como</p>
<div class="displaymath">
\begin{equation*}
\int_0^\infty e^{-x}x^k~ dx = k!
\end{equation*}
</div>
<p data-braille="continuation">o resultado segue.</p>
<p id="p-538">Mais detalhes em breve.</p></article></div>
<article class="technology computation-like" id="technology-23"><h6 class="heading">
<span class="type">Tecnologia</span><span class="space"> </span><span class="codenumber">2.3.21</span><span class="period">.</span>
</h6>
<p id="p-539">Usando o <a class="xref" data-knowl="./knowl/teo-permutacao-caotica-repet.html" title="Teorema 2.3.20">Teorema 2.3.20</a> para calcular o número de soluções do <a class="xref" data-knowl="./knowl/exem-perguntainternet.html" title="Exemplo 2.3.16">Exemplo 2.3.16</a>. Foram usados os métodos <em class="emphasis">abs</em> e <em class="emphasis">integral</em> que calculam o valor absoluto e a integral, respectivamente.</p>
<div class="sagecell-sage" id="sage-36"><script type="text/x-sage">abs(integral(exp(-x)*laguerre(3,x)*laguerre(2,x)^2*laguerre(1, x)^3, (x, 0, +oo)))
</script></div></article><article class="technology computation-like" id="technology-24"><h6 class="heading">
<span class="type">Tecnologia</span><span class="space"> </span><span class="codenumber">2.3.22</span><span class="period">.</span>
</h6>
<p id="p-540">A implementação da função <dfn class="terminology">DR</dfn> (derangement with repetition) usando o <a class="xref" data-knowl="./knowl/teo-permutacao-caotica-repet.html" title="Teorema 2.3.20">Teorema 2.3.20</a>. Os parâmetros são as quantidades que cada elemento figura na lista. Por exemplo, para a palavra MATEMATICA usamos a entrada 3, 2, 2, 1, 1, 1, pois são 3 letras A, 2 letras T, 2 letras M, 1 letras E, 1 letra I e 1 letra C.</p>
<div class="sagecell-sage" id="sage-37"><script type="text/x-sage">def DR(*lista):
    n = sum(lista)
    p = exp(-x)
    for i in lista:
        p = p*laguerre(i, x)
    return abs(integral(p, (x, 0, +oo)))
DR(3, 2, 2, 1, 1, 1)
</script></div></article></section><section class="exercises" id="exercises-9"><h3 class="heading hide-type">
<span class="type">Exercícios</span> <span class="codenumber">2.3.3</span> <span class="title">Exercícios</span>
</h3>
<article class="exercise exercise-like" id="exercise-67"><h6 class="heading"><span class="codenumber">1<span class="period">.</span></span></h6>
<p id="p-541">(PRMO 2019) Diremos que um rearranjo das letras de uma palavra não tem letras fixas, quando o rearranjo é colocado diretamente abaixo da palavra, e nenhuma coluna tem a mesma letra repetida. Por exemplo, HBRATA é um rearranjo sem letras fixas de BHARAT. Quantos rearranjos distinguíveis sem letras fixas que BHARAT tem? (As duas letras A são consideradas idênticas.)</p>
<div class="solutions">
<a data-knowl="" class="id-ref answer-knowl original" data-refid="hk-answer-67" id="answer-67"><span class="type">Resposta</span></a><div class="hidden-content tex2jax_ignore" id="hk-answer-67"><div class="answer solution-like"><p id="p-542">84</p></div></div>
</div></article></section></section></div></main>
</div>
</body>
</html>
